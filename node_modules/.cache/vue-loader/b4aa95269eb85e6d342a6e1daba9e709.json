{"remainingRequest":"/Users/matiascaballero/matidev/abg/abg-custom-element-product-selector/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/matiascaballero/matidev/abg/abg-custom-element-product-selector/src/components/ContentTypeSelector.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/matiascaballero/matidev/abg/abg-custom-element-product-selector/src/components/ContentTypeSelector.vue","mtime":1623329223080},{"path":"/Users/matiascaballero/matidev/abg/abg-custom-element-product-selector/node_modules/cache-loader/dist/cjs.js","mtime":1623402537694},{"path":"/Users/matiascaballero/matidev/abg/abg-custom-element-product-selector/node_modules/thread-loader/dist/cjs.js","mtime":1623402537712},{"path":"/Users/matiascaballero/matidev/abg/abg-custom-element-product-selector/node_modules/babel-loader/lib/index.js","mtime":1623402537665},{"path":"/Users/matiascaballero/matidev/abg/abg-custom-element-product-selector/node_modules/cache-loader/dist/cjs.js","mtime":1623402537694},{"path":"/Users/matiascaballero/matidev/abg/abg-custom-element-product-selector/node_modules/vue-loader/lib/index.js","mtime":1623402546143}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBNdWx0aXNlbGVjdCBmcm9tICJ2dWUtbXVsdGlzZWxlY3QiOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIE11bHRpc2VsZWN0CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2VsZWN0ZWRUeXBlczogdGhpcy52YWx1ZSB8fCBbXSwKICAgICAgb3B0aW9uczogW10sCiAgICAgIGlzTG9hZGluZzogdHJ1ZQogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmZldGNoVHlwZXMoKTsKICB9LAogIHByb3BzOiB7CiAgICBlbGVtZW50OiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICBjb250ZXh0OiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICB2YWx1ZTogewogICAgICB0eXBlOiBPYmplY3QKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGxpbWl0VGV4dChjb3VudCkgewogICAgICByZXR1cm4gYGFuZCAke2NvdW50fSBvdGhlciBjb3VudHJpZXNgOwogICAgfSwKICAgIGFzeW5jIGZldGNoVHlwZXMocXVlcnkpIHsKICAgICAgY29uc3QgZmlyc3RVcGRhdGVWYWx1ZSA9IHRoaXMuZWxlbWVudC5jb25maWcuUVVFUlkucmVwbGFjZSgKICAgICAgICAiIyNxdWVyeSMjIiwKICAgICAgICBxdWVyeQogICAgICApOwogICAgICBjb25zdCBsYXN0VXBkYXRlVmFsdWUgPSBmaXJzdFVwZGF0ZVZhbHVlLnJlcGxhY2UoIiMjcXVlcnkjIyIsIHF1ZXJ5KTsKICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlOwogICAgICBhd2FpdCBmZXRjaCh0aGlzLmVsZW1lbnQuY29uZmlnLkFQSSwgewogICAgICAgIG1ldGhvZDogInBvc3QiLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCYXNpYyAke3RoaXMuZWxlbWVudC5jb25maWcuQVBJX0FVVEh9YCwKICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIKICAgICAgICB9LAogICAgICAgIGJvZHk6IGxhc3RVcGRhdGVWYWx1ZQogICAgICB9KQogICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHJlc3BvbnNlLmpzb24oKSkKICAgICAgICAudGhlbihqc29uID0+IHsKICAgICAgICAgIHRoaXMub3B0aW9ucyA9IGpzb24uaGl0cy5oaXRzLm1hcChwcm9kdWN0ID0+IHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBpZDogcHJvZHVjdC5fc291cmNlLnByb2R1Y3RmaWVsZHMudW5pcXVlX2lkLAogICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QuX3NvdXJjZS5wcm9kdWN0ZmllbGRzLnByb2R1Y3RfbmFtZVsiZW4tdXMiXSwKICAgICAgICAgICAgICBkaW1lbnNpb25zOgogICAgICAgICAgICAgICAgcHJvZHVjdC5fc291cmNlLnByb2R1Y3RjYXJkICYmCiAgICAgICAgICAgICAgICBwcm9kdWN0Ll9zb3VyY2UucHJvZHVjdGNhcmQuZGltZW5zaW9uc2luLAogICAgICAgICAgICAgIGltYWdlOgogICAgICAgICAgICAgICAgcHJvZHVjdC5fc291cmNlLnByb2R1Y3RjYXJkICYmCiAgICAgICAgICAgICAgICBwcm9kdWN0Ll9zb3VyY2UucHJvZHVjdGNhcmQuZmVhdHVyZWltYWdlLAogICAgICAgICAgICAgIHF1YW50aXR5OiAxLAogICAgICAgICAgICAgIHByaWNlX2NhZDogcHJvZHVjdC5fc291cmNlLnByb2R1Y3RmaWVsZHMuYmFzZV9wcmljZV9jYWQsCiAgICAgICAgICAgICAgcHJpY2VfdXNkOiBwcm9kdWN0Ll9zb3VyY2UucHJvZHVjdGZpZWxkcy5iYXNlX3ByaWNlX3VzZAogICAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0pOwogICAgfSwKICAgIG9uU2VsZWN0OiBmdW5jdGlvbigpIHsKICAgICAgdGhpcy5zYXZlKHRoaXMuc2VsZWN0ZWRUeXBlcyk7CiAgICB9LAogICAgc2F2ZTogZnVuY3Rpb24odmFsdWUpIHsKICAgICAgdGhpcy4kZW1pdCgidXBkYXRlOnZhbHVlIiwgdmFsdWUpOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["ContentTypeSelector.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2FA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ContentTypeSelector.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <multiselect\n      v-model=\"selectedTypes\"\n      :key=\"option\"\n      placeholder=\"Select products\"\n      open-direction=\"bottom\"\n      :hide-selected=\"true\"\n      :options=\"options\"\n      :option-height=\"104\"\n      :multiple=\"true\"\n      :loading=\"isLoading\"\n      :internal-search=\"false\"\n      :close-on-select=\"false\"\n      label=\"name\"\n      track-by=\"name\"\n      :disabled=\"element.disabled\"\n      @input=\"onSelect\"\n      @onChange=\"onSelect\"\n      @search-change=\"fetchTypes\"\n      :clear-on-select=\"false\"\n      :options-limit=\"300\"\n      :limit-text=\"limitText\"\n      :custom-label=\"customLabel\"\n      :show-labels=\"false\"\n    >\n      <template slot=\"tag\" slot-scope=\"props\">\n        <div class=\"container selectedproduct\">\n          <div class=\"imageContainer\">\n            <img\n              class=\"option__image\"\n              :src=\"props.option.image\"\n              :alt=\"props.option.name\"\n            />\n            <div class=\"events\">\n              <span class=\"remove\" @click=\"props.remove(props.option)\">❌</span>\n              <span\n                class=\"add\"\n                @click=\"props.option.quantity = props.option.quantity - 1\"\n                >➖</span\n              >\n              <span\n                class=\"add\"\n                @click=\"props.option.quantity = props.option.quantity + 1\"\n                >➕</span\n              >\n              <span\n                class=\"remove\"\n                @click=\"selectedTypes.push([]) && selectedTypes.pop()\"\n                >✔</span\n              >\n            </div>\n          </div>\n          <span class=\"option__desc\">\n            <span class=\"option__title\"\n              ><strong>{{ props.option.name }}</strong></span\n            >\n            <span class=\"option__title\">{{ props.option.id }}</span>\n            <span class=\"option__title\"\n              ><strong>Qty: </strong> {{ props.option.quantity }}</span\n            >\n            <span class=\"option__title\"\n              ><strong>CAD: </strong> {{ props.option.price_cad }}</span\n            >\n            <span class=\"option__title\"\n              ><strong>USD: </strong> {{ props.option.price_usd }}</span\n            >\n          </span>\n        </div>\n      </template>\n\n      <template slot=\"option\" slot-scope=\"props\"\n        ><img\n          class=\"option__image\"\n          :src=\"props.option.image\"\n          :alt=\"props.option.name\"\n        />\n        <div class=\"option__desc\">\n          <span class=\"option__title\"\n            ><strong>{{ props.option.name }}</strong></span\n          ><span class=\"option__small\">{{ props.option.id }}</span>\n          <span class=\"option__small\">{{ props.option.dimensions }}</span>\n          <span class=\"option__small\">CAD:{{ props.option.price_cad }}</span>\n          <span class=\"option__small\">USD:{{ props.option.price_usd }}</span>\n        </div>\n      </template>\n    </multiselect>\n  </div>\n</template>\n\n<script>\nimport Multiselect from \"vue-multiselect\";\n\nexport default {\n  components: {\n    Multiselect\n  },\n  data() {\n    return {\n      selectedTypes: this.value || [],\n      options: [],\n      isLoading: true\n    };\n  },\n  created() {\n    this.fetchTypes();\n  },\n  props: {\n    element: {\n      type: Object,\n      required: true\n    },\n    context: {\n      type: Object,\n      required: true\n    },\n    value: {\n      type: Object\n    }\n  },\n  methods: {\n    limitText(count) {\n      return `and ${count} other countries`;\n    },\n    async fetchTypes(query) {\n      const firstUpdateValue = this.element.config.QUERY.replace(\n        \"##query##\",\n        query\n      );\n      const lastUpdateValue = firstUpdateValue.replace(\"##query##\", query);\n      this.isLoading = true;\n      await fetch(this.element.config.API, {\n        method: \"post\",\n        headers: {\n          Authorization: `Basic ${this.element.config.API_AUTH}`,\n          \"Content-Type\": \"application/json\"\n        },\n        body: lastUpdateValue\n      })\n        .then(response => response.json())\n        .then(json => {\n          this.options = json.hits.hits.map(product => {\n            return {\n              id: product._source.productfields.unique_id,\n              name: product._source.productfields.product_name[\"en-us\"],\n              dimensions:\n                product._source.productcard &&\n                product._source.productcard.dimensionsin,\n              image:\n                product._source.productcard &&\n                product._source.productcard.featureimage,\n              quantity: 1,\n              price_cad: product._source.productfields.base_price_cad,\n              price_usd: product._source.productfields.base_price_usd\n            };\n          });\n          this.isLoading = false;\n        });\n    },\n    onSelect: function() {\n      this.save(this.selectedTypes);\n    },\n    save: function(value) {\n      this.$emit(\"update:value\", value);\n    }\n  }\n};\n</script>\n\n<style src=\"vue-multiselect/dist/vue-multiselect.min.css\"></style>\n<style scoped></style>\n"]}]}